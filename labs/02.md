---
title: "Resonance Tube"
chapter: "2"
part: "labs"
numbersections: true
---

# Ensembles

The density operator formalism is useful for treating ensembles of quantum systems. 

The general state of a quantum system can be described by the ket $\ket\psi = \sum_i c_i \ket{x_i}$, where the $c_i$ are probability amplitudes for each basis state $\ket{x_i}$. E.g. the state of a spin-$\tfrac 12$ system could be

$$
\ket\psi = \tfrac{1}{\sqrt 2} \ket{+} + \tfrac{1}{\sqrt 2} \ket{-} 
\label{egSpin12State}
$$

This is a **coherent superposition** since it describes the exact relative phase between the $\ket +$ and $\ket -$ states. 

However this ket only describes a *single* system pointing in a specific direction. It doesn't give a general description of a collection of quantum systems.  

An **ensemble** is a collection of $N$ systems. Suppose each system can be in one of $n$ states, $\ket{\psi_i}$ for $i = [1, ..., n]$. We denote the ensemble

$$
\big \{ \p_i, \ket{\psi_i} \big \} \hspace{1cm} i = [ 1, ..., n]
$$

where each $\p_i$ represents the relative proportion (or fractional probability) of the state $\ket{\psi_i}$ in the population. 

Note the probability measure $\p_i$ is not the same as the probability given by $| c_i |^2$. The latter is a quantum-mechanical concept; it gives the probability of finding a *specific* system in the state $i$ if you measure it. The probabilities $| c_i |^2$ are derived from the complex amplitudes $c_i$, which contain specific information about the relative phases between states. 

Meanwhile $\p_i$ gives the proportion of members in the ensemble that are expected to occupy the state $\ket{\psi_i}$. It has no information about the relative phases between states. $\p_i$ is essentially a concept from frequentist probability theory. If you sample from the ensemble, the proportion of $\ket{\psi_i}$ should converge to $\p_i$ in the long run.  

By the law of total probability, the probabilities $\p_i$ satisfy

$$
\sum_i \p_i = 1
$$

# Random, Mixed, Pure Ensembles

A **random ensemble** is a collection of particles with random spin orientations. E.g. a beam of silver atoms from an oven that haven't (yet) been interfered with. Such a beam is **unpolarised**. Since it's a spin-$\tfrac 12$ system we expect a roughly 50/50 split between the $\ket +$ and $\ket -$ states respectively, so $\p_+ = 0.5$ and $\p_- = 0.5$. 

A **pure ensemble** is a collection of particles which can all be described by the same ket. E.g. a previously unpolarised beam of silver atoms which gets filtered through a SG device. All the spins in the emergent beam point in a single direction. The beam is **polarised**.  

A **mixed ensemble** contains a certain (known) fraction of particles in each state. Such a beam is **partially polarised**. 


# Expected Value of an Ensemble

For a ket in the state $\ket\psi$, the expected value of observable $\op X$ is given by:

$$
\E [\op X] = \bra\psi \op X \ket\psi
$$

[(see proof)](./) 

For an ensemble of kets $\ket{\psi_i}$, it follows that the expected value of $\op X$ should be weighted again by the relative proportion of that state in the ensemble, i.e. 

$$
\E [\op X] = \sum_i \p_i \bra{\psi_i} \op X \ket{\psi_i}
$$

Expanding this in terms of the eigenkets $\ket{x_i}$ of $\op X$:

$$
\bal
\E [\op X] &= \sum_i \p_i \bra{\psi_i} \op X \ket{\psi_i} \\ 
&= \sum_{ijk} \p_i \braket{\psi_i}{x_j} \bra{x_j} \underbrace{\op X \ket{x_k}}_{= x_k \ket{x_k}} \braket{x_k}{\psi_i} \\  
&= \sum_{ij} \p_i  x_k \braket{\psi_i}{x_j} \underbrace{\braket{x_j}{x_k}}_{= \delta_{jk}} \braket{x_k}{\psi_i} \\
&= \sum_{ij}\p_i x_j \braket{\psi_i}{x_j} \braket{x_j}{\psi_i} \\ 
&= \sum_{ij} \p_i x_j \big| \braket{x_j}{\psi_i} \big|^2
\eal
$$

Note there are two probability measures in this equation: 

- the quantum-mechanical probability $| \braket{x_j}{\psi_i} |^2$ of finding the state $\ket{\psi_i}$ in the eigenstate $\ket{x_j}$, and 
- the relative probability $\p_i$ of finding the state $\ket{\psi_i}$ in the ensemble. 

# The Density Operator

When expanding $\E [\op X]$ in terms of the basis kets $\ket{x_i}$, we noted that

$$
\E [\op X] = \sum_{ij} \p_i \braket{\psi_i}{x_j} \bra{x_j} \op X \ket{x_k} \braket{x_k}{\psi_i}
$$

Rearranging:

$$
\E [\op X ] = \sum_{jk} \bigg( \sum_i \p_i \braket{x_k}{\psi_i} \braket{\psi_i}{x_j} \bigg) \bra{x_j} \op X \ket{x_k} 
$$

Define the **density operator** of an ensemble: 

$$
\op\rho = \sum_i \p_i \ket{\psi_i} \bra{\psi_i}
$$

which has matrix elements

$$
\op \rho \xrightarrow[x]{} \bra{x_k} \op\rho \ket{x_j} = \sum_i \p_i \braket{x_k}{\psi_i} \braket{\psi_i}{x_j}
$$

Thus the expected value of an operator over an ensemble can be written

$$
\E[\op X] = \sum_{jk} \bra{x_k} \op\rho \ket{x_j} \bra{x_j} \op X \ket{x_k} = \t{tr} (\op\rho \op X )
$$

In a pure ensemble there is only one state $\ket\psi$ so the density operator is

$$
\op\rho = \ket\psi \bra\psi
$$

The density operator is Hermitian:

$$
\op\rho\adj = \op\rho
$$

and idempotent:

$$
\op\rho^2 = \op\rho \hspace{2cm} \op\rho(\op\rho - 1) = 0
$$

:::{.proof}
**Example:** the density operator for a polarised beam in the $\ket{{+z}}$ state:

$$
\op\rho = \ket{{+z}} \bra{{+z}} = \bm 1 \\ 0 \ebm \bm 1 & 0 \ebm = \bm 1 & 0 \\ 0 & 0 \ebm
$$
:::

:::{.proof}
**Example:** the density operator for an unpolarised spin-$\tfrac 12$ system:

$$
\bal
\op\rho &= \tfrac 12 \ket + \bra + + \tfrac 12 \ket - \bra - \\ 
\\ 
&= \frac 12 \bm 1 \\ 0 \ebm \bm 1 & 0 \ebm + \frac 12 \bm 0 \\ 1 \ebm \bm 0 & 1 \ebm \\ 
\\ 
&= \bm \tfrac 12 & 0 \\ 0 & \tfrac 12 \ebm
\eal
$$
:::

# Time Evolution

Suppose an ensemble evolves with time. If the system is closed, then the relative proportion of each state $\p_i$ cannot change, i.e. $\ddt{\p_i} = 0$. Thus the evolution of the density operator must depend only on the evolution of the state kets:

$$
\ddt{\op \rho} = \ddt{} \bigg( \sum_i \p _i \ket{\psi_i} \bra{\psi_i} \bigg) = \sum_i \p_i \ddt{} \bigg( \ket{\psi_i} \bra{\psi_i} \bigg)
$$

We know that state kets evolve according to the Schr√∂dinger equation

$$
i\hbar \ddt{} \ket{\psi} = \op H \ket\psi
$$

Thus the time evolution of the density operator is:

$$
\bal
i\hbar \pd{\op\rho}{t} &= \sum_i \p_i \bigg[ i\hbar \pd{}{t} \bigg( \ket{\psi_i} \bra{\psi_i} \bigg) \bigg] \\ 
&= \sum_i \p_i \bigg[ \underbrace{\bigg( i\hbar \pd{}{t} \ket{\psi_i} \bigg)}_{\op H \ket{\psi_i}} \bra{\psi_i} + \ket{\psi_i} \underbrace{\bigg( i\hbar \pd{}{t} \bra{\psi_i} \bigg)}_{-\bra{\psi_i} \op H} \bigg] \\ 
&= \sum_i \p_i \bigg[ \op H \ket{\psi_i}\bra{\psi_i} - \ket{\psi_i} \bra{\psi_i} \op H \bigg] \\ 
&= \op H \op \rho - \op \rho \op H \\ 
&= -[\op\rho, \op H]
\eal
$$

Note also that the evolution of state kets from $t_1$ to $t_2$ can be described by a unitary transformation $\op U(t_1, t_2)$, such that $\ket{\psi} \xrightarrow[t_1 \rightarrow t_2]{} \op U \ket{\psi}$. It follows that

$$
\op\rho \xrightarrow[t_1 \rightarrow t_2]{} \op U \op\rho \op U \adj
$$

# Continuous Space

In continuous space the elements of the density matrix are

$$
\bal
\bra{x_j} \op\rho \ket{x_k} &= \bra{x_j} \bigg( \sum_i \p_i \ket{\psi_i} \bra{\psi_i} \bigg) \ket{x_k} \\ 
&= \bra{x_j} \bigg( \sum_i \p_i \iint \ket{x_j} \underbrace{\braket{x_j}{\psi_i}}_{\psi_i(x_j)} \underbrace{\braket{\psi_i}{x_k}}_{\psi_i \cj (x_k)} \bra{x_k} \; \d x_j \d x_k \bigg) \ket{x_k} \\ 
&= \sum_i \p_i \psi_i(x_j) \psi_i \cj (x_k) \\ 
\eal
$$

# References

Sakurai, *Modern Quantum Mechanics*

Nielsen and Chuang, *Quantum Computation and Quantum Information* 

